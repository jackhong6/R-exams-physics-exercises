```{r, echo = FALSE, results = "hide"}
pace_minutes <- sample(3:8, 1) # minutes part of pace per kilometre
pace_seconds <- sample(1:59, 1) # seconds part of pace per kilometre
d <- 42.195 # marathon distance in km

t <- round(d * (pace_minutes * 60 + pace_seconds)) # time in seconds to finish the marathon
#t_h <- t %/% 3600 # number of hours to finish the marathon
#t_m <- t %/% 60 # number of minutes to finish the marathon
#t_s <- t %% 60 # number of seconds to finish the marathon

sc <- num_to_schoice(t, delta = 10, format = FALSE)
sc$questions <- sapply(sc$questions, round)
sc$questions <- sprintf("\\si{%02d:%02d:%02d}", sc$questions %/% 3600, (sc$questions %/% 60) %% 60, sc$questions %% 60)
```

Question
========
A runner finishes a marathon (\SI{42.195}{km}) with an average pace of \SI{`r pace_minutes`}{minutes} and \SI{`r pace_seconds`}{seconds} per \si{kilometre}. What is the runner's time for the marathon? (Answers are formatted as \si{hours:minutes:seconds})

```{r questionlist, echo = FALSE, results = "asis"}
answerlist(sc$questions, markup = "markdown")
```

Solution
========
First, calculate the speed in kilometres per second.
```{r, echo = FALSE, results = "asis"}
v <- signif(1 / (pace_minutes * 60 + pace_seconds), 5)
```
$$v = \frac{\SI{1}{km}}{\SI{`r pace_minutes*60`}{s} + \SI{`r pace_seconds`}{s}} = \SI{`r v`}{km/s}$$
Then, calculate the time using the formula for constant velocity motion.
$$ t = \frac{d}{v} = \frac{\SI{`r d`}{km}}{\SI{`r v`}{km/s}} = \SI{`r format(t, scientific = FALSE)`}{s}$$
Finally, convert the number of seconds into hours, minutes, and seconds. (\SI{60}{s} = \SI{1}{minute} and \SI{60}{minutes} = \SI{1}{hour})

$$\SI{`r format(t, scientific = FALSE)`}{s} = \SI{`r t %/% 3600`}{hours}, \SI{`r (t %/% 60) %% 60`}{minutes}, \SI{`r t %% 60`}{seconds}$$

Meta-information
================
exname: calculate marathon time given pace
extype: schoice
exsolution: `r mchoice2string(sc$solutions)`
exshuffle: 4
